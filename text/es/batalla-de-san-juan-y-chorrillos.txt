La batalla de San Juan y Chorrillos fue una acción militar ocurrida el 13 de enero de 1881, en el marco de la Guerra del Pacífico. En ella se enfrentaron el Ejército de Chile y el Ejército del Perú. 
Esta batalla se desarrolló consecutivamente en Villa, las pampas de San Juan y Santa Teresa, el cerro Marcavilca, el morro Solar y el pueblo de Chorrillos. Después de ocho horas de combates en diversos frentes, el ejército chileno resultó victorioso. Luego de la batalla, hubo incendios y saqueos en Chorrillos y Barranco. También se acordó una tregua, el llamado Armisticio de San Juan, y se efectuaron negociaciones mientras ambos ejércitos hacían preparativos para otra posible batalla, que finalmente se produjo por un confuso incidente que derivó en la batalla de Miraflores, después de la cual las tropas chilenas entraron a Lima y pusieron fin a la tercera campaña terrestre de la guerra.
Fue la mayor batalla librada durante la guerra y una de las más grandes de América del Sur, en lo que concierne al número de combatientes. Según algunos historiadores debió finalizar la Campaña de Lima con este enfrentamiento, ya que los remanentes peruanos en la línea defensiva de Miraflores no estaban en situación de contener el avance chileno.
Después de asegurado el dominio chileno en Tarapacá, Arica y Tacna, en Chile se discutió el siguiente paso a seguir en la guerra. El gobierno mismo había intentado infructuosamente romper la alianza Perú-Bolivia mediante la oferta de los territorios de Arica como la natural salida al mar. Una fuerte corriente de opinión desconfiaba del éxito de tal "política boliviana" y exigía al gobierno continuar la guerra con la invasión a Lima, pero el presidente de Chile Aníbal Pinto deseaba evitar mas derramamiento de sangre y acabar con los costos del esfuerzo bélico. Como una solución intermedia, que debía demostrar al gobierno peruano su incapacidad para defender su territorio y la conveniencia de aceptar las condiciones de paz exigidas por Chile, el gobierno chileno ordenó la Expedición Lynch con orden de cobrar contribuciones a los ricos hacendados de las azucareras e impedir los desembarcos de armas que llegaban desde Panamá. El mismo fin tenía la Expedición a Mollendo. Casi paralelamente se concretó la intervención estadounidense a través de William Evarts, secretario de estado del presidente James Garfield, quien promovió la Conferencia de Arica con el fin de detener el conflicto, que dañaba el comercio y la industria de la región y hacía temer a los EE.UU. una intervención europea en asuntos hemisféricos contraria a la Doctrina Monroe. Chile exigía la cesión de Tarapacá, una indemnización monetaria, la devolución del vapor Rímac y la abrogación del Pacto Secreto Perú – Bolivia de 1873. Arica, según las exigencias chilenas, debía quedar en manos de Perú, pero desmilitarizada. Sin embargo, el ministro plenipotenciario de EE.UU. en Bolivia Charles Adams había asegurado a los aliados que en caso de no llegar los beligerantes a un acuerdo durante la conferencia, los EE.UU. impondrían a Chile un arbitraje favorable a los aliados. Por esa razón para los gobiernos de Campero y Piérola era mejor no entregar los territorios ocupados y dejar a los EE.UU. imponer la paz sin cesión de territorios.[6]​[7]​[8]​Tras el fracaso de la conferencia de Arica, el rechazo boliviano a las ofertas chilenas de dejar la alianza con Perú y la negación peruana a negociar, el gobierno chileno, deseoso de terminar la guerra, decidió la ocupación de Lima.
Por la falta de capacidad de transporte marítimo, los desembarcos chilenos debían ocurrir en forma escalonada. El puerto de Chilca, situado 70 km al sur de Lima, fue elegido como punto de desembarco por estado mayor chileno dado que se pensaba que la presencia de fuerzas peruanas importantes era poco probable.
El 20 de noviembre de 1880 desembarcó en Paracas, cerca de Pisco, proveniente desde Arica, al mando del general José Antonio Villagrán Correas, la 1.ª División del Ejército chileno de 8.800 hombres, embarcada en 15 transportes y las corbetas Chacabuco y O'Higgins. La División fue reforzada con 3.500 soldados que llegaron el 2 de diciembre en la corbeta Abtao y la cañonera Magallanes al mando del coronel José Francisco Gana Castro. Esta división debía marchar hacia el norte, pero por falta de medios solo continuó la brigada bajo el mando de Patricio Lynch, y el resto de la división debió volver a Pisco desde donde se reembarcó al norte. Tras este inconveniente, el Jefe del Ejército chileno ordenó el regreso de Villagrán a Chile y su reemplazo por Lynch.
El 22 de diciembre desembarcaron en Curayaco y Lurín 15.000 soldados chilenos y el material de guerra desde 29 transportes bajo la protección de los blindados Blanco Encalada y Cochrane, la corbeta O'Higgins y el transporte Angamos. El 25 y 26 de diciembre llegaron sucesivamente, después de ocho días de marcha, las dos mitades de la brigada Lynch, que se seguían con 24 horas de intervalo para facilitar el aprovechamiento en víveres y agua. Este trayecto de 180 km se hizo casi sin resistencia peruana, que consistió principalmente en ataques de montoneras locales.
Las tropas chilenas establecieron su campamento en el valle de Lurín que ofrecía agua, forrajes y alimentos a las fuerzas expedicionarias.
El mando peruano envió al coronel Pedro José Sevilla y los Cazadores del Rímac, con 200 jinetes armados con carabinas, a vigilar el avance de los chilenos, enfrentándolos en Yerba Buena (Cañete) y luego en Bujama (Mala). El mando chileno envió a la brigada del coronel Orozimbo Barbosa a enfrentar las tropas peruanas, librándose el combate del Manzano el 27 de diciembre de 1880 donde Sevilla es tomado prisionero.
Las tropas chilenas realizaron confiscaciones de dinero y ganado a los ricos propietarios del valle de Cañete. A su paso liberaron culís que eran mantenidos semi-esclavizados en las haciendas de la zona, los que se pusieron al servicio del ejército y ayudaron en el transporte de material, apertura de senderos, excavación de trincheras, desactivación de minas, atención de los heridos y entierro de los muertos. De las haciendas confiscadas fueron requisados más de seiscientos asnos, los que fueron cargados con sacos, armas y utensilios de cocina.[8]​
Para reconocer el terreno, el ejército expedicionario realizó varias expediciones a la zona entre la línea de defensa peruana y Lurín. El mismo jefe de las fuerzas chilenas, Baquedano, salió al terreno tres veces: por el camino a Ate y por la Tablada de Lurín (lado costero). También efectuaron reconocimientos Barbosa y Carlos Wood. El más intensivo fue el de Orozimbo Barbosa, que llevo efectivos de las tres armas (infantería, caballería y artillería), con el fin de dilucidar la factibilidad de un ataque envolvente por Ate.[8]​
En la Rinconada de Ate se encontraba desde el 4 de enero de 1881 el coronel peruano Mariano Vargas con una fuerza de 340 soldados, compuesta por los hacendados y pobladores de la zona armados con fusiles Minié y piezas de artillería. Vargas dispuso su artillería en el cerro Vásquez. El 9 de enero de 1881, la división chilena de Barbosa llegó a Pampa Grande (Musa, La Planicie) después de una marcha por la quebrada de Manchay desde Pachacámac (Lurín). La división de Barbosa se enfrentó con los hombres de Vargas en el combate de La Rinconada de Ate, logrando la retirada de Vargas hasta el cerro Vásquez, donde la artillería peruana entra en acción pero sin ocasionar pérdidas de consideración a la división chilena, que después de inspeccionar la zona se retira a Pampa Grande.
La franja costera entre el río Rimac y el río Lurin tiene un ancho promedio de 4 km y esta limitada al este por las últimas estribaciones occidentales de la cordillera de los Andes y al oeste por el océano Pacífico. Casi en su centro corre una línea de cerros que comienza a la orilla del mar con el Morro Solar (de hasta 280 m de altura), continua con los cerros de Santa Teresa, Zigzag, San Juan, Viva El Perú (todos ellos con una altura de hasta 180 m) y por último los cerros Pamplona (280 m) que cierran el paso al norte por el lado este con su conexión al cerro Cascajal. Los flancos son arenosos y de difícil acceso.[9]​[notas 1]​ 
La línea semeja vagamente una "W". Al norte de la línea se ubicaban terrenos de cultivos regados por el río Surco que era extraído del Rímac. Aparte de Lima tenía algunos poblados como Barranco, Miraflores, Teves y Chorrillos.
Al sur de la "W" se extendía una zona arenosa, casi despoblada hasta Lurín, con excepción de "Villa", un poblado a 2 kilómetros al sur de Santa Teresa. Se le llamaba a toda la extensión la "Tablada de Lurín".
Mas al este, existía un camino, a veces solo sendero, desde Manchay hasta Ate y desde allí a Lima. Ese camino pasaba por el lado norte del cerro Monterrico Chico.
Existieron en el estado mayor chileno dos alternativas para derrotar las defensas peruanas. La de un ataque frontal, propuesta por Baquedano, y la de un movimiento envolvente por el ala derecha chilena, que fue impulsada por el ministro de guerra en campaña José Francisco Vergara.
La propuesta de Vergara consistía en seguir por el valle del Lurín río arriba hasta Manchay y luego seguir al norte a través de terrenos blandos y valles cerrados, sin agua, para llegar al este de Lima por Ate (ver mapa de F. Machuca). Las tropas chilenas llegarían así a las espaldas de las defensas peruanas que, descolocadas, no opondrían una resistencia eficaz. 
El plan tenía varias ventajas: evitaba un sangriento ataque frontal, tenía un gran efecto psicológico y facilitaba la captura de los vencidos. 
Sin embargo también existían problemas difíciles de solucionar. El camino no era expedito sino solo huellas en terrenos por los el transporte de cargas pesadas de artillería y bagajes solo podían ser hechas con gran esfuerzo, demora y quizás eran imposibles. Además, no había agua hasta llegar a Lima y en los valles era fácil para el ejército peruano detener la marcha de los expedicionarios en los valles cerrados que debían atravesar.
Finalmente, en un consejo de guerra efectuado el 11 de enero con la participación de Baquedano, José Francisco Vergara, todos los generales, los coroneles Velásquez, Lynch, Altamirano, Lira y el enviado presidencial Joquín Godoy, el estado mayor chileno decidió el ataque frontal. Se argumentó que la marcha directa de Lurín a San Juan era de 17 kilómetros, en cambio la envolvente por Ate era tres veces mayor por caminos arenosos, sin el apoyo de la escuadra, y en una línea muy extendida vulnerable a un ataque por los flancos.
Conocido el desembarco chileno en Chilca, Nicolás de Piérola dispuso construir las líneas de defensa al sur de Lima, en San Juan y Miraflores, las que estuvieron bajo la asesoría del ingeniero alemán Máximo Gorbitz[11]​ y el ingeniero peruano Felipe Arancivia.[11]​ En el cerro San Cristóbal se construyó una fortaleza llamada "Ciudadela Piérola" encargada al marino Manuel Villavicencio.
La línea de San Juan, de 15 km de largo, se encontraba a 12 km de Lima y se extendía sobre las colinas descritas anteriormente. También se fortaleció las alturas del cerro Monterrico, aisladas de la línea de San Juan y de la de Miraflores, que debían repeler un posible ataque chileno según el plan de J. F. Vergara. Las defensas tenían parapetos, fosas y campo de tiro despejado de arbóles y cercas que pudiesen cubrir a los atacantes:
Las pircas tenían de un metro a metro y medio de altura y eran formadas por la superposición de pequeños trozos de rocas o "lajas" acomodadas cuidadosamente. Su espesor era de 80 cm a un metro, lo que bastaba para detener las balas de fusil, pero no de cañón que desmoronaban el inestable amontonamiento.[10]​En el abra de Santa Teresa, San Juan y otros lugares, los defensores habían instalado minas que estallaban bajo el peso de un soldado. En la vía férrea Miraflores-Chorrillos se contaba con un tren blindado dotado de cañones y paralelo a la línea férrea había una línea telegráfica que comunicaba el estado mayor con el frente. Los cerros Marcavilca y Morro Solar, a orillas del mar, contaban con trincheras y baterías que defenderían contra un posible desembarco por Chorrillos o La Chira. Entre San Juan y los cerros Pamplona existía una angostura plana de 500 metros de ancho en la que fue cavada una fosa para reforzar las defensas.
El gobierno peruano encargó la construcción de cañones a las fábricas peruanas White, Grieve y Selay. Las tropas peruanas contaban con armamento de diversas fabricaciones y calibres, como fusiles Chassepot, fusiles Peabody, fusiles Minié de avancarga, carabinas Remington de calibre .43 y calibre .50. Desde diciembre de 1879 hasta el comienzo de la campaña de Lima, Perú había importado 30.000 fusiles y 60 ametralladoras además de otros materiales de guerra como torpedos, dinamita, alambres, etc. Esta información es conocida, pero ha sido desdeñada más tarde bajo el influjo de la derrota y de la pasión política por la historia peruana, afirma Jorge Basadre.[11]​
En tanto, el Ejército de Chile, al mando del general Manuel Baquedano, desplegó sus cuatro divisiones; a la izquierda la 1.ª División al mando de Patricio Lynch. Hacia el centro la 2.ª División dirigida por Emilio Sotomayor y más a la derecha la 3.ª División al mando del comandante Pedro Lagos. Detrás se ubicaría la Reserva, bajo el mando del comandante e ingeniero militar Arístides Martínez. De acuerdo a lo propuesto por el ministro se distribuyó la artillería de montaña entre las tres divisiones y con la artillería de campaña se organizó un Regimiento de Artillería de Campaña n°2 que junto a la caballería quedó bajo ordenes directas del comandante en jefe.[2]​El plan de Baquedano consistía en embestir con las tres divisiones la línea enemiga y romperla donde estuviera más débil.
Por otra parte, la Armada de Chile, al mando del almirante Galvarino Riveros Cárdenas había ordenado desplegar en la noche del 13 de enero los buques chilenos Blanco Encalada, Cochrane, O’Higgins y Pilcomayo al frente del Morro Solar, con la misión de batir las defensas peruanas de ese lugar durante la batalla al aclarar el día. Pero al realizarse el ataque desde tierra cuando aún no aclaraba y al observarse al amanecer el ascenso de las tropas chilenas al Morro, la flota chilena no pudo cañonear en forma general esa posición. Limitándose entonces a apoyar a las tropas de tierra con algunos disparos seguros de los buques y una lancha a vapor que ametralló las posiciones peruanas.[2]​
La disposición de las fuerzas encontró a Pastor Dávila frente a Pedro Lagos, Andrés Cáceres a Emilio Sotomayor, y a Miguel Iglesias a Patricio Lynch. En la reserva peruana estaba Belisario Suárez y en la reserva chilena Arístides Martínez.
Aunque según el plan de Baquedano las tres divisiones chilenas debían actuar paralelamente, en realidad la niebla de guerra causó primero el retraso de la división de Sotomayor y el rechazo de Iglesias a la división de Lynch por lo que usualmente se divide la batalla en fases sucesivas: Santa Teresa, San Juan, Morro Solar y Chorrillos.
El día 12 de enero a las 16:00 comenzaron a salir de Lurín los regimientos chilenos para tomar posiciones frente a la línea de defensa peruana. La amplitud de la pampa (17 km) significó una marcha dificultosa para las fuerzas chilenas. El regimiento Coquimbo y el batallón Melipilla de la división Lynch marcharon por el camino (costero) de Conchan hasta la ladera oeste del Morro Solar y el resto de la división se ubicó frente a Villa y Santa Teresa. La segunda división (Sotomayor) se extravió o demoró en llegar hasta el abra de San Juan. La tercera división, de Lagos, marchó por Otocongo para impedir que Dávila pudiese concurrir en ayuda de Iglesias o Cáceres. A las 03:00 del día 13 los chilenos llegaron a sus emplazamientos, con excepción de Sotomayor.
Las defensas peruanas, a pesar de la densa niebla y la obscuridad de la noche, estaban informadas del comienzo de las acciones por dos fuentes independientes, un prisionero chileno y un soldado peruano que había escapado de sus captores chilenos.[8]​ A las 3:00, Cáceres alistó sus tropas ordenando rancho y ron. A las 4:30, el comandante Lynch entró en acción encontrándose con las fuerzas de Cáceres, siendo el batallón del coronel Pablo Arguedas el primero en entrar en combate. La 2.ª División bajo el mando de Sotomayor no alcanzó a intervenir oportunamente, complicada por la oscuridad, la neblina y las dificultades del terreno, retrasándose 45 minutos.
El general Pedro Silva ordenó a la reserva de Belisario Suárez tomar posición en la zona había ocupado en días previos, para reforzar así la zona entre San Juan y Pamplona.
Los hombres de Iglesias estaban dispuestos en guerrilla y se enfrentaron a la división de Lynch. El Cuerpo IV de Cáceres amagó a la 1.ª división (Lynch). Baquedano notó la situación y ordenó a Martínez apoyarle con la tropa de reserva, a la vez que instó más rapidez a Sotomayor para entrar en combate. A las 6:00 ambos ejércitos se encontraron en acción en todo el frente, resguardados por la artillería.
Lynch atacó el flanco peruano que defendía las casas de Villa, que, asediado por las tropas de la 2. División chilena, cedió cerca de las 8:00 de la mañana. Iglesias reunió los batallones Guardia Peruana n.º 1 y Callao n.º 9 que habían combatido en Villa, combinándolos con los batallones Cajamarca n.º 5, Tacna n.º 7 y Trujillo n.º 11, sumando en total 2.500 soldados, retirándolos en dirección a Marcavilca.
El general Emilio Sotomayor, que había recibido la orden de atacar el centro de la línea peruana, pero había perdido el camino hacia el frente y llegó con casi una hora de atraso para inmediatamente atacar entre San Juan y Pamplona. El coronel Gana, por iniciativa propia había dirigido al Regimiento Buin hacia las alturas del sur de San Juan, antes que Sotomayor llegara allí, preparando el lugar para la carga. En el camino entre Lurín y Pachacamac se enfrentaron a la columna de guardias del coronel Negrón a quienes diezmaron. Visto el desplazamiento de las fuerzas chilenas, el general Silva ordenó que los batallones Ayacucho 83 y Libertad del cuerpo de Dávila que cubrieran el campo entre San Juan y Pamplona.
Sotomayor inició el ataque entre San Juan y Pamplona, enfrentando la línea peruana en 45.º, dando las espaldas por un momento a la 2.ª División y atacando la izquierda que defendía Dávila, cubiertos por el Regimiento Buin, dirigiéndose hacia la trinchera donde se encontraban los batallones Ayacucho 83 y Libertad. Sotomayor también ordenó a la 2.ª Brigada, comandada por Orozimbo Barbosa que venía más atrás, atacar de frente y por su flanco izquierdo, las trincheras de Dávila.
Como la carga continuaba en este punto, el general Pedro Silva envió al Huánuco 17 del cuerpo de Suárez, pero apenas iniciado su ataque, es herido su comandante, el coronel Mas. Silva decidió enviar también al batallón Paucarpata 19 de la reserva, que no logró reforzar al Huánuco 17, ya que en pampa Gramadal se enfrentaron a las fuerzas chilenas.
El Regimiento Buin cargó contra el reducto del cerro Viva el Perú atacándolo por el frente y los flancos. Los batallones peruanos que vendrían a reforzarlos, más los restos de los defensores del cerro, retrocedieron al ver la posición tomada por los chilenos. El Paucarpata 19 se desorganizó y se retiró de la línea y con ellos también el Huánuco 17. El general Silva decidió enviar al batallón Canta, pero el Ayacucho 83 y el Libertad, ya desbandados, se retiraron de la posición que defendían. Seguidamente la división chilena se dirigió al este, enfrentándose a los batallones restantes de Dávila, que ordenó el repliege por La Calera, retirándose de la línea de San Juan.[10]​En el centro, las fuerzas de Canevaro y Cáceres fueron atacadas también por el flanco izquierdo. El general Silva dispuso enviar al batallón del coronel Augusto Barrenechea y luego al batallón del coronel Lorenzo Rendón para apoyar a Canevaro. La posición fue imposible sostener por lo que se retiran de la línea.
El general Baquedano envió a los Carabineros de Yungay al mando del teniente coronel Manuel Bulnes Pinto. Apoyados por los Granaderos de Tomás Yávar, con órdenes de desbandar la retirada peruana. El general Pedro Silva envió a la 5.ª Brigada de Caballería al mando del coronel Morales Bermúdez, para proteger la retirada de las fuerzas peruanas.
Los Carabineros y granaderos continuaron su carga, hasta llegar a la Pampa de Tebes, donde debieron detenerse por la acción de las fuerzas peruanas. En la retirada, Cáceres y Canevaro se encargaron de reunir a los dispersos, reorganizándolos con el fin de enfrentar a las tropas chilenas.[12]​
El general Silva ordenó a los batallones restantes de la reserva del cuerpo de Suárez dirigirse a Chorrillos, sufriendo bajas en la contramarcha. Los coroneles Cáceres, Valle y Carrillo se encargaron finalmente de reunir a los dispersos para dirigirlos a Barranco en dirección de la línea de Miraflores.
El coronel Miguel Iglesias, jefe del I Cuerpo de ejército, reunió los batallones Guardia Peruana n.º 1 y Callao n.º .9 que habían combatido en Villa, los que combinados con los batallones Cajamarca n.º .5, Tarma n.º 7 y Trujillo n.º 11 sumaban 2.500 soldados en dirección de Marcavilca.
Luego de las acciones de San Juan, parte de la 2.ª Brigada de la 1.ª División, compuesta por los regimientos 4.º de Línea, Chacabuco, más el Regimiento de Artillería de Marina avanzaron hacia Marcavilca. El coronel Arnaldo Panizo observó desde el Morro Solar el repliegue de las fuerzas de Iglesias y apoyó su retirada con la batería "Provisional", dando resultado su ofensiva. Iglesias organiza el ataque con el I cuerpo y de ésta forma el avance chileno es detenido cerca del cerro "La Calavera". En ese punto una parte de la tropa del regimiento Chacabuco fue muerta o herida, cayendo 19 oficiales y 350 soldados, asumiendo el mando el tercer comandante, el mayor Quintavalla. Lo mismo ocurrió en el Regimiento 4.º de Línea.[8]​Patricio Lynch mandó a pedir refuerzos, pero su ordenanza fue muerto y Baquedano no se enteró de sus dificultades por encontrarse en la villa de Chorrillos. En ese momento comenzaron a faltar las municiones en la artillería y la infantería debió retroceder. Se solicitaron refuerzos al comandante Pedro Lagos que se encontraba en las casas de San Juan. El primer oficial en recurrir a la ayuda de la división de Lynch fue, por su propia voluntad, Diego Dublé Almeyda comandante del regimiento Atacama, que trajo también municiones. Esto permitió que se detuviera la retirada chilena y reiniciara su ofensiva.
Iglesias realizó un contraataque liderados por el batallón Libres de Trujillo y el Zepita n.º .29 de Suárez que atacaron a las tropas chilenas, para luego salir de los parapetos haciendo retroceder a los atacantes y recuperando las posiciones que habían dejado en Santa Teresa. El Atacama que fue reducido a la mitad y el Talca llegó tarde a la ofensiva.
A las 7:00 de la mañana, la cañonera Pilcomayo y la lancha Toro empiezan a disparar contra las posiciones peruanas del Morro Solar, y libran un combate de una hora con los cañones que miraban al mar.
Los regimientos 4.º de Línea, Chacabuco y la artillería chilena fueron reforzados por un batallón del regimiento Valparaíso y los Zapadores. Conducida por Francisco Barceló llegó la 2.ª Brigada de la III división, compuesta por los regimientos Concepción y Santiago, más los batallones Bulnes, Valdivia y Caupolicán, este último comandado por José María del Canto.
Ante estos refuerzos chilenos los hombres del I cuerpo de Iglesias se retiran hacia Marcavilca donde combaten junto con los restos de los batallones que pelearon en Villa y Santa Teresa.**[cita requerida][13]​ Miguel Iglesias y otras fuerzas peruanas como el Zepita n.º .29, al encontrarse ya con la retaguardia chilena, decidieron marchar hacia Chorrillos. Piérola se encontraba en Marcavilca durante estas acciones y se retiró a Miraflores cuando retrocedió Iglesias.
Los regimientos Coquimbo y Melipilla se aproximaron por la playa Conchán y fueron atacados por el batallón Guardia Peruana n.º 1, al mando de Carlos de Piérola y el batallón Ayacucho n.º 3 desde el cerro Marcavilca, deteniendo su avance.
Patricio Lynch dividió sus fuerzas en dos; una parte atacaría de frente, mientras la otra marcharía flanqueando el cerro. El comandante Soto atacó por el flanco, pero ante las descargas de la artillería peruana de Marcavilca hizo detener a su tropa y mandó a cargar sobre las posiciones peruanas, perdiendo la vida en el intento; el comandante del regimiento Melipilla debió asumir el mando y junto al comandante del regimiento Coquimbo, Marcial Pinto Agüero, consiguieron desalojar a los defensores peruanos.[12]​ A las 12:00, las fuerzas del I Cuerpo peruano dejaban sus posiciones en Marcavilca y se retiraron en dirección a Chorrillos y otros hacia el Morro Solar, atacados por los chilenos desde Marcavilca.**[cita requerida][13]​ El Zepita n.º 29 logra entrar por la calle Lima y combatir en Chorrillos.
A las 13:45 en la cima del Morro Solar se encuentran los últimos 100 soldados de diversos batallones del I cuerpo, y los artilleros de la batería "Mártir Olaya" al mando del coronel Arnaldo Panizo, quienes rodeados defienden sus posiciones. La ametralladora que operaba el mayor Hurtado y Haza quedó inutilizada y continuó operando una pieza de 12. Finalmente las tropas chilenas ocuparon la planicie del Morro Solar.
A la villa de Chorrillos fueron enviados los batallones del cuerpo de Suárez que no habían participado en San Juan. Suárez, al ver la defensa que realizaba Iglesias en el Morro Solar continuó con la defensa de la villa.
Luego de las acciones en San Juan, el general Baquedano reorganizó el ejército chileno y a las 10:30 de la mañana envió hacia Chorrillos la división completa de Emilio Sotomayor junto a la brigada de Urriola, 2 brigadas de artillería de montaña, la de artillería de campaña y ordenó además el traslado del cuartel general hacia un punto más cercano a las futuras acciones. Los regimientos Bulnes y Concepción participarían conjuntamente en las acciones en el Morro Solar y Chorrillos. La artillería chilena protegió tanto el avance de la División de Sotomayor hacia Chorrillos como el de la brigada de Francisco Barceló hacia el Morro Solar.
Al ver el avance chileno hacia la villa de Chorrillos, el coronel Arnaldo Panizo que se encontraba en la cima del morro, ordenó a la batería Mártir Olaya disparar contra el avance chileno, logrando detenerlo tres veces en el camino entre San Juan y Chorrillos.
Suárez defendió su posición con el batallón Zepita 29 al mando de Isaac Recabarren, que fue diezmado, luego envió a los batallones Ancash 25 y Jauja 23, que tuvieron que retirarse de Chorrillos. Chorrillos fue rodeado por las tropas de Pedro Lagos y Urriola. Los regimientos chilenos Bulnes y Valdivia se acercaron a la parte del villorio que apuntaba al Morro. El Regimiento Esmeralda, el 3.º de Línea, un batallón del regimiento Valparaíso más el 'Regimiento Aconcagua avanzaron por el norte del poblado.
Suárez organizó a los dispersos del Ancash 25 y el Jauja 23 que junto al Concepción enfrentaron nuevamente a las fuerzas chilenas. Los detalles de esta acción sólo pueden ser narrados en general, pues los defensores peruanos se parapetaron en cada casa, esquina y habitación, y los atacantes chilenos con el fin de desalojarlos, prendieron fuego a las casas. Desde la línea de Miraflores se enviaron refuerzos por medio del tren blindado, siendo éste detenido por el fuego de artillería y la infantería chilena. Las tropas de Suárez finalmente se retiraron hacia Barranco con dirección a la línea de Miraflores.
Cerca de tres horas duraron los combates en Chorrillos, que fue destruido casi totalmente por la acción de la artillería de tierra, el incendio y los combates entre las tropas chilenas y peruanas.
Según William F. Sater, los peruanos muertos en la batalla fueron entre 4000-7000, sus heridos 3000 y entre 2000 a 3000 fueron hechos prisioneros por los chilenos. Las bajas chilenas, también según Sater, fueron 797 muertos y 2522 heridos.[5]​ En su parte oficial del 28 de enero al gobierno, el jefe del Estado Mayor peruano general Pedro Silva, manifiesta que es imposible dar una cifra oficial de las bajas peruanas. Así mismo la cifra dada por Baquedano en su parte oficial es solo una estimación.[2]​ De hecho Sater cita mayoritariamente fuentes chilenas como fuente de su información y previene que son imprecisas porque no dan información sobre los que murieron posteriormente a consecuencia de sus heridas.[5]​Todos los autores coinciden en la magnitud de las bajas chilenas y peruanas con excepción de Jorge Basadre, quien, sin dar fuentes, asegura que los chilenos tuvieron entre 5000 y 6000 muertos en la batalla.[11]​En las acciones de Marcavilca hasta el Morro Solar, el ejército chileno sufrió la pérdida de 88 oficiales y 1873 soldados entre muertos y heridos. De los 5200[14]​ hombres de Iglesias que combatían aquí, fueron hechos prisioneros 280 hombres. Entre los prisioneros se encontraban el coronel Miguel Iglesias,[2]​ Guillermo Billingurst,[2]​ Carlos de Piérola, hermano de Nicolás de Piérola. Entre los muertos se encontraba Alejandro Iglesias, hijo de Miguel Iglesias.
Tras la batalla las divisiones Lynch y Martínez (reserva) quedaron al pie del Morro, la Sotomayor, Lagos y la caballería quedaron entre Chorrillos y San Juan. Al día siguiente a Lagos le fue ordenado colocarse inmediatamente al sur de Barranco, poblado que fue quemado hasta los cimientos por orden de Baquedano.[10]​
Como consecuencia de los encarnizados combates, el balneario de Chorrillos fue incendiado y destruido y también saqueado, en eso coinciden todos los autores.[2]​[15]​ Más aún, civiles indefensos, en número desconocido, fueron víctimas de la violencia. Sergio Villalobos lo describe como sigue:[15]​
El choque fue desordenado por ambas partes y tomó el carácter irregular, lleno de sorpresas que es propio de los encuentros en los centros urbanos, con el agregado del alcohol y del robo.Sin embargo, los historiadores difieren en quienes participaron en los hechos y sus causas finales. Los historiadores peruanos Dellepiane[16]​ y Basadre[17]​ sostienen que sólo los soldados chilenos cometieron desmanes en Chorrillos. Pero Sergio Villalobos advierte que también los peruanos saqueaban y se embriagaban.[18]​ El historiador Wilhelm Ekdahl considera que la responsabilidad de los hechos recae sobre el alto mando peruano que ordenó continuar la resistencia en un lugar poblado con civiles indefensos.[2]​Durante la noche Cáceres y César Canevaro insistieron en avanzar hacia Chorrillos, al frente cinco mil o más soldados peruanos, para hacer un ataque sorpresa a los chilenos. Piérola se negó a autorizar esta operación que consideró muy riesgosa. Aunque Cáceres, en sus memorias, insiste en sostener que se perdió una oportunidad única para infligir al enemigo un grave revés, lo cierto era que, descontando a los soldados chilenos ebrios e indisciplinados (quienes, según cálculos del historiador Carlos Dellepiane, no sobrepasaban el número de dos mil[11]​), el grueso del ejército chileno se hallaba a cubierto de una sorpresa.[19]​
En la mañana del día 14 de enero, el ministro chileno José Francisco Vergara, por petición de gran parte del alto mando chileno y en aras de que no se repitieran los hechos pasados, envió al coronel Miguel Iglesias junto a Isidoro Errazúriz como emisarios al dictador Nicolás de Piérola para señalar la "inutilidad de derramar más sangre". Iglesias pudo conversar con Piérola, pero Errazúriz no fue recibido, ya que Piérola solo hablaría con un ministro oficial. Iglesias cumplió su palabra de regresar como prisionero.
Con el interés de salvaguardar las propiedades de la ciudad, entre ellas las propiedades de extranjeros, se establecieron como parlamentarios de la tregua los cónsules extranjeros M. de Vorges de Francia, Spencer Saint John de Gran Bretaña y Jorge Tezanos Pinto de El Salvador, que llegaron en un tren con bandera blanca a Chorrillos desde Lima. En la tarde del día 14 se reunieron con el alto mando chileno, pero Baquedano los citó para el día 15 en la mañana por que consideró que era ya muy tarde.
El día 15 de enero se reunieron los diplomáticos extranjeros y los chilenos Manuel Baquedano, Guillermo Lira y José Francisco Vergara. Manuel Baquedano exigió la rendición incondicional del Callao. Los negociadores le pidieron tiempo para consultarlo con Piérola. Entonces se acordó de palabra que se detenían las hostilidades hasta las 12:00 horas. Las tropas chilenas realizaron algunos desplazamientos.
Mientras Nicolás de Piérola se encontraba en Miraflores recibiendo a los extranjeros Tezanos Pinto, De Vorges, Saint John, Sterling y Bergasse du Petit Thouars, considerando las condiciones pedidas por los chilenos, el general Manuel Baquedano, el coronel Pedro Lagos y otros oficiales se encontraban por su lado practicando reconocimientos en el terreno. Un confuso incidente (un tiroteo cruzado) dio inicio a la Batalla de Miraflores a las 2:30 pm del 15 de enero de 1881.
Según el historiador peruano Dellepiane, la línea de defensa estaba mal concebida por varios motivos. Primero, su larga extensión no podía ser cubierta adecuadamente por el limitado número de defensores. Esto implicaba una falta de profundidad en la defensa: si la línea era atravesada por los atacantes, estos podrían atacar libremente a los restantes defensores por la espalda. Tampoco se pensó en preparar contraataques cuando se diese la posibilidad. Sobre la construcción de la pirca, Dellepiane sostiene que si bien detenía los disparos de fusil, multiplicaba los efectos de los disparos de cañón pues cada piedra se rompía y disparaba en su entorno sus pedazos como esquirlas.[10]​El establecimiento de dos líneas de defensa paralelas es también causa de la crítica de Dellepiane: se impide la acumulación de fuerzas en el momento de la batalla, un concepto básico de la teoría militar, y moralmente se da entender al defensor de la primera línea que su comandante no cree que la línea resistirá.
La opinión de Dellepiane sobre Baquedano no es positiva en parte debido a que hizo un ataque lineal en todo el frente en vez de concentrar su ataque en el punto más débil de la defensa. Casualmente, el envío de las reservas a su flanco izquierdo concentró el peso sobre la parte más fuerte de la defensa, el Morro Solar en vez del paso al lado del Cerro Pamplona y el Cascajal, que era el más apropiado.[10]​Sobre la efectividad de las líneas peruanas, el diplomático argentino Dámaso Uriburu, dice que "El ejército que él [el Dictador] había organizado para concurrir a la defensa de la capital sólo tenía de ejército el nombre".[20]​ El ingeniero estadounidense Paul Boyton narra que "Las tropas eran de indígenas quienes habían sido reclutados en las cordilleras y casi forzados a luchar [...] cientos de ellos nunca habían visto antes una ciudad".[21]​ El escritor Robert Scheina, recogiendo el relato del marino Theodorus Mason, indica que "La artillería peruana no era efectiva y las tropas estaban armadas con rifles de calibres diferentes que frecuentemente tenían municiones incorrectas"[22]​
En vista de que los oficiales perdieron el control de la tropa cuando esta saqueó y se embriagó en Chorrillos, Baquedano ordenó el 14 de enero quemar el poblado de Barranco antes de enfrentar las fortificaciones de Miraflores para así evitar los peligros de indisciplina y su efecto sobre su eficiencia,.[23]​[9]​En esta batalla participaron seis oficiales que luego serían presidentes del Perú: Justiniano Borgoño, Lizardo Montero, Guillermo Billinghurst, Miguel Iglesias, Andrés Avelino Cáceres y el entonces mandatario Nicolás de Piérola.
Armatambo, un complejo arqueológico situado en la margen izquierda del valle bajo del río Rímac, en las faldas del Morro Solar
Pachacámac (sitio arqueológico) restos de diversos edificios de diferentes épocas precolombinas a orillas del río Lurín
Barros van Buren, Manuel (1958). Historia Diplomática de Chile (1541-1938). Santiago de Chile: Editorial Andrés Bello. 
Bulnes, Gonzalo (1914). Guerra del Pacífico. vol. 2: De Tarapacá a Lima (PDF). Valparaíso: Sociedad Imprenta y Litografía Universo. p. 740. 
Bulnes, Gonzalo (1956). «Batalla de Chorrillos». La Guerra del Pacífico. Santiago: Editorial del Pacífico. v. 2, p. 331-343. 
Dellepiane, Carlos (1977). Historia Militar del Perú 2. Lima, Perú: Ministerio de Guerra del Perú, Biblioteca Militar. 
Basadre, Jorge (2014-9). Historia de la República del Perú (1822 - 1933) 9. Lima: Empresa Editora El Comercio S. A. ISBN 9972-205-71-1. Archivado desde el original el 16 de diciembre de 2017. 
Basadre, Jorge (2014-8). Historia de la República del Perú (1822 - 1933) 8. Lima: Empresa Editora El Comercio S. A.  (enlace roto disponible en Internet Archive; véase el historial y la última versión).
Encina, Francisco Antonio; Castedo, Leopoldo (1999). Resumen de la Historia de Chile (Encina-Castedo). Santiago de Chile: Sociedad Editorial Santiago Ltda. 
Milla Bartres, Carlos (1979). Compendio histórico y recopilación de partes y documentos de la Guerra del Pacífico. Editorial Milla Bartres. 
Paz Soldán, Mariano Felipe (1979). Narración histórica de la guerra de Chile contra el Perú y Bolivia. Tomo III. Lima: Milla Batres. 
Ekdahl, Wilhelm (1919-3). Historia Militar de la Guerra del Pacífico entre Chile, Perú y Bolivia (1879-1883) III. Santiago de Chile: Imprenta del Ministerio de Guerra. 
Machuca, Francisco A. (1929). Las Cuatro Campañas de la Guerra del Pacífico 3. Imprenta Victoria Valparaíso. 
Sater, William F. (2007). Andean Tragedy: Fighting the War of the Pacific, 1879–1884 (en inglés). Lincoln and London: University of Nebraska Press. ISBN 978-0-8032-4334-7. 
Villalobos, Sergio (2004). Chile y Perú, la historia que nos une y nos separa, 1535-1883 (2 edición). Chile: Editorial Universitaria. ISBN 9789561116016. 
Vicuña Mackenna, Benjamín (1881-2). Historia de la Campaña de Lima. Calle del Puente n° 15, Santiago de Chile.
Partes oficiales de las batallas de Chorrillos i Miraflores libradas por el ejército chileno contra el peruano en los días 13 i 15 de enero de 1881